# Example: Compass Gait Walker (Two-Link Walker)

## Main scripts

### BRT Computation

(You can skip this part if you want to directly use the precomputed data for simulations.)
1. Run [`cal_brt_compass_gait_walker.m`](reachability/cal_brt_compass_gait_walker.m).
2. Once the computation is done, postprocessing the value function is required to use the value function for the online control synthesis. In this process, tables of the time-to-reach values and the gradients of the value function are produced. Run [`set_reachability_post_evaluation.m`](reachability/postprocess/set_reachability_post_evaluation.m) to create the post-processed data.

### Precompted Data
You can download the precomputed value functions [here](https://drive.google.com/drive/folders/1Pyh97DBfLuLyyQvrisEF3VBZGv_dMhiV?usp=sharing). The BRT is computed for T=1.5s.

### Evaluations

For visualization of the BRT, run [`vis_value_functions.m`](scripts/vis_value_functions.m).

For demonstration of the CLF-QP (the baseline controller), run [`two_link_main_clf_qp.m`](scripts/two_link_main_clf_qp.m).

For demonstration of the reachability-based controller, run [`two_link_main_opt_ctrl.m`](scripts/two_link_main_opt_ctrl.m).

## Quick navigation

- `scripts` contains the main scripts for the demonstration and visualization of this example.

- `@CompassWalker` is the helperOC dynsys class that implements the compass-gait walker dynamics and its optimal control and disturbance policies for reaching the target gait. 

- `sim` contains the main functions that run the simulation and the controllers.

- `gen` contains functions that are used for the simulation of the dynamics that are auto-generated by matlab. These files can be generated by running the scripts in the `setup` folder.

- `reachability` contains the functions required for running the HJ reachability computation.

- `reference_gait` contains the gait files used in the paper. `x_opt_star_ral.mat` contains the gait parameters, and `gait_from_clf_qp_ral.mat` contains data of the actual hybrid periodic orbit under the CLF-QP baseline controller.

- `reset_event` contains files related to checking the reset event.

- `reset_map` contains files related to applying the reset map to the states.

- `visualize` contains functions that create plots.
